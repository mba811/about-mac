# 网络、邮件和文件共享

Mac新电脑的安装过程很简单，开机就会自动进入引导安装界面，提示用户设置语言（简体中文）、选择国家（中国）、选择键盘布局（中文-简体）、选择全新Mac还是从其他Mac迁移数据、启用定位、登录iCloud帐号（需要联网）、最后创建登录密码就完成了安装。

> 如果没有Apple ID在安装过程的iCloud环节免费申请一个@iCloud.com的邮箱来作为你的Apple ID。
> 
> iCloud会基于你的Apple ID在不同设备之间完成邮件、日历、照片、联系人以及iWork文档等信息的同步。

进入系统以后，不用着急安装第三方的软件，做好前期的一些设置和调教会让后面的软件部署和数据迁移工作更顺畅。

Mac环境配置的第一步首先是保障「三通」，也就是：网络畅通、邮件畅通、共享畅通。

### 网络偏好设置

网络的通畅和速度决定了后面下载、升级、更新的速度和稳定性，加入公司的局域网还可能需要手动设定IP地址。另外如果要顺畅的使用Gmail、Dropbox、Feedly等应用和服务，VPN或SSLedge代理的上网方式也是必须的。
￼
![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/01.png)

网络偏好设置入口

通过顶栏的WIFI图标进入具体的「网络偏好设置」，也可以通过「-系统偏好设置-网络」的方式进入。

为了说明的方便，图中集中展示了需要设置和了解的所有界面，虽然看上去有很多项，不过实际使用中根据场景的不同只需要设置其中的部分。

![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/02.png)


网络偏好设置面板

网络偏好设置界面左侧的列表中会列出所有可用的连接，已经连接的网络会显示为绿色的圆点。

点击「网络偏好设置」左下角的「高级」按钮将进入详细的网络参数设置界面，手动配置IP地址、添加更快的DNS和设置代理服务器都在这个界面中。

  1. 网络位置，网络位置会保存当前界面中的Wi-Fi、以太网端口等一组连接的网络设置，包括「高级」设置中的DNS、代理等信息。如果要经常更改网络设置，你会发现在位置间切换比重复修改单组设置更快速和容易。例如，为了方便访问Gmail，在公司的网络里你需要设置代理，回到家中又不需要，那么在回家后与其打开网络偏好设置去修改代理设置，还不如新建一个不包含代理参数的网络位置，分别命名成「Home」和「Work」，以后随时切换就可以。

  2. 添加删除连接，添加新的网络连接，通过下方的「+−」按钮可以添加其他的网络连接，例如，VPN连接。

  3. VPN连接有两种类型，需要和VPN服务提供商确认是PPTP还是L2TP，并将获得的服务器地址和密码输入界面中。还需要注意的一点是，在保存VPN设置以后，需要到VPN的高级设置中需要勾选「通过VPN连接发送所有流量」。
￼

![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/03.png)


VPN设置选项

  4. 齿轮键，如果同时连接了WIFI和有线网络，「Wi-Fi」「Thunderbolt Ethernet」都会显示为绿色圆点，至于优先使用那个网络来通讯由它们的服务顺序决定，点击左侧的网络列表下面的齿轮图标，选择「设定服务顺序」，在弹出窗口中通过拖拽调节连接服务的顺序。

服务优先顺序有什么作用呢？举例来说，假如你正连着WiFi网络，这个时候插上网线，由于默认有线连接的服务优先级更高，这个时候所有的网络请求就不再走无线网卡了，而是走有线网卡，通常这样不会有什么问题，反正都能上网，走有线反而速度更快一些。但是也有一些特殊情况，例如，公司的内网有访问限制甚至无法访问互联网，而部门自己的无线路由器可以通过ADSL访问外网，按系统默认设置的情况，插上网线就会导致无法继续访问外网，要解决这种问题，可以人工添加路由策略来判断内网外的连接请求。

    * 首先，确定服务顺序中WIFI连接处在第一位；
    * 然后，给有线连接增加一个路由判断。打开终端（Terminal）输入以下命令。
`sudo route -n add 192.168.1.0/16 192.168.1.1`

> 命令行范例中192.168.1.0是内网的网段，/16是子网掩码，4代表255.0.0.0，8代表255.255.0.0，16代表255.255.255.0，192.168.1.1是内网网关地址。

以上Route命令将内网网段的连接请求都交由有线网卡来处理，这样就不会和外网连接的无线网卡发生冲突了，不过Mac中这条命令没法固化下来重启机器后需要重新添加。

  5. WIFI，如果有多个WIFI连接都可以访问，那么系统会按照WIFI首选网络列表中的顺序优先连接排在前面的WIFI网络，用户可以通过拖拽来调节顺序。

如果启用了iCloud中的钥匙串（「系统偏好设置-iCloud」）功能，使用相同iCloud帐号的iPhone或者iPad登录过的WIFI连接也会同步到这里，所以当你打开笔记本的时候发现能自动连上网不用感到奇怪。同理，在这里删除WIFI连接后也会通过iCloud同步到其他设备。

  6. TCP/IP，公司局域网有时候会要求每台电脑必须使用固定的IP，可以通过「高级」中的TCP/IP页进行配置，具体的IP地址填写信息咨询网管。

  7. DNS，适当的DNS地址能提高网络访问和下载的速度，这里推荐使用114.114.114.114，114.114.115.115 作为DNS服务器地址。

其他常用的DNS还有
Ali：223.5.5.5，223.6.6.6
V2EX：199.91.73.222，178.79.131.110
Google：8.8.8.8，8.8.4.4
Open DNS：208.67.222.222，208.67.220.220

  8. 代理，如果采用的是VPN的方式上网，不需要设置代理信息。图示中是因为采用全局代理的方式来访问Gmail、Dropbox的，所以勾选了Http和Socks代理，其中Socks代理是给Dropbox使用的。

VPN的方式很简单，只需要获得账户和口令就能访问，不过连接断开后需要人工再次连接，另外就是VPN依赖于好的网络，如果本地网络不好，甚至路由器某些设置不对都可能导致 VPN 无法连接。所以如果对通畅的网络访问有比较高的要求和访问密度时，还是建议采用SSL的方式代理上网。

**Mac通过无线路由器连接到局域网如何设置？**
为了让Macbook能轻松上网，一般都习惯直接连Wi-Fi，因为连网线不仅要单独配一根转接线，还是略显累赘。所以很多人是直接买个小的无线路由器插上公司的网线。

无线路由器后面一般有四到五个网口，一个标为WAN或Internet，其余多个标为LAN，所以网线连接到无线路由器也有两种方式：

  1. 接到LAN网口形成的就是LAN到LAN的模式，无线路由器只相当于一台「无线交换机」，此时你Mac的网络设置（TCP/IP需手动配置IPv4）要和局域网里其他台式机一样，如果公司采用的是静态IP，除了不重复的IP地址，其他的子网掩码、网关都需要一样才行。

> LAN到LAN的连接方式中， 无线路由器里只需要将本地网络中的路由器IP（也就是你登录路由器的管理地址192.168.1.1一类的）改成局域网网段里的IP。

  2. 如果将网线接到无线路由器的WAN口上，Mac获得的是无线路由器动态分配给你的IP，网络设置里设置（TCP/IP默认是DHCP）保持默认的DHCP自动获取IP地址就可以。

> LAN到WAN的连接方式中，需要将路由器互联网设置中的IP地址按你局域网里的其他台式机一样设置好IP、子网掩码和网关，另外，本地网络设置里保持默认值设置并开启DHCP服务就可以了。

### 邮件设置

OS X中已经预置了一些流行的电子邮件服务商，例如，Google、Yahoo，国内的则有163、126和QQ邮箱，这类已经预置了配置文件的邮箱只需要输入正确邮箱地址和用户名密码就能快速的完成设置。

多数情况下需要我们人工参与的主要是企业邮箱，国内企业邮箱的类型以POP居多，外企则是采用IMAP类型的居多。POP邮箱在多台设备上收邮件时很容易造成「丢信」和「重复下载」，而与 POP 不同，IMAP 可在网络与电子邮件客户端之间提供双向通信，操作动作会反馈到服务器端，提供了从多台设备访问邮件的更好方法。

对于配置邮箱帐号来说，POP邮箱和IMAP邮箱的区别会表现在收件服务器的地址上，POP邮箱的收件服务器地址类似于POP.163.com，而IMAP邮箱的收件服务器地址类似于IMAP.163.com。

不管那一类的邮箱，配置通常都是围绕以下几个部分展开：

  1. 你的邮件地址，例如：well@gmail.com；
  2. 收件服务器地址和用户名、密码，有些企业邮箱要求用户名填写完整的邮件地址;
  3. 发件服务器地址，点击发件服务器的展开箭头可以跳转到发件服务器的详细设置界面，如果不是特殊的端口，只需要填写用户名和密码就可以；
  4. 点击邮箱配置的「高级」按钮弹出的窗口是收件服务器的端口设置，IMAP邮箱这里默认端口是993，并勾选了「使用SSL」。如果是POP邮箱这里通常是110，并且不勾选SSL项。
￼

![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/04.png)


默认「邮件」程序会以向导的形式帮用户配置邮箱帐号，只有检索不到对应的配置文件时才会要求用户一步一步的选择邮箱类型、填写收件服务器、发件服务器、用户名和密码等信息。配置企业邮箱时你可以等程序走完流程以后再回到「邮件」的「账户」页面检查和修改具体的参数。

配置完成后可以通过「邮件」程序菜单栏「窗口-连接诊断」来查看配置时候成功，如果存在问题也能在窗口中得到具体的反馈。

> 邮箱地址和密码确认没有问题的情况下，一般容易出错的部分就是收件服务器的端口和「使用SSL」的问题，还有就是SMTP发件服务器是否需要勾选「使用加密套接字协议SSL」的问题。

### 文件共享

**Mac间的简单共享**
局域网内传递文件最简单的方式就是开启共享文件夹的方式，Windows和Mac系统都是如此，像Windows中通过资源管理器查看网上邻居一样，Mac中同样可以在Finder中看到局域网上的其他计算机。

Mac之间可以方便的通过AirDrop实现共享，在Finder中打开AirDrop，只要在雷达图中看到对方的图标，直接拖拽文件就可以完成分享。

![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/05.png)

WIFI 网络中AirDrop共享方式有一定的局限性，首先对方也必须同时打开 AirDrop，文件发送后还需要等待对方确认，另外 AirDrop 对传输的距离有一定要求，稍微远一点可能就看不到对方了。

添加一个共享文件夹来交换文件比 AirDrop 更简单，同网段的其他用户都可以在 Finder 中看到你「共享」的文件夹，也可以自由读写。不需要的时候到「系统偏好设置-共享」里关闭即可。

  1. Finder 中通过菜单「前往-电脑」；
  2. 找到系统默认的共享文件夹，「Macintosh HD-用户-共享」；
  3. 通过拖拽，在 Finder 边栏创建方便访问的共享文件夹替身
  4. 打开「系统偏好设置-共享」；
  5. 勾选「文件共享」添加共享文件夹，完成

默认开启「文件共享」后，还会自动添加一个「公共文件夹」，其他用户只能往其中「投件箱」放文件，看不到也无法打开。

**和Windows用户共享文件夹**
要让局域网中的其他Windows用户要访问Mac的共享文件夹需要确定几个地方：

  1. 首先是工作组的命名是一致的，NetBIOS的名称也就是Windows用户在网上邻居中所看到的你机器的名称。到「系统偏好设置-网络-WINS」项中检查；

![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/06.png)

系统偏好设置-网络-WINS

  2. 「系统偏好设置」中「用户与群组」中确认已经勾选了客人用户的「允许客人连接到共享文件夹」。

> 提示：即便勾选了「客人用户」的共享文件夹访问权限，在「共享」设置的选项中依旧是看不到Guest账户的，它是一个隐藏的账户。

![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/07.png)

Guest共享设置

**重要：不用勾选图示中「共享-选项」里的管理员帐号，管理员帐号将会获得访问你所有磁盘内容的权限。同事间的共享告诉对方用「guest」帐号登录就可以了。**

工作组、客人账户两项都OK，Windows用户就可以正常访问Mac的共享文件夹，在资源管理器的文件地址栏直接输入Mac的 `\\IP地址`或者 `\\设备名称`就会弹出密码和口令的登录界面。

![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/08.png)

**从Mac访问Windows的共享**
Windows中共享文件的方式和上面描述的Mac分享文件的方式类似，首先在「控制面板\用户帐户和家庭安全\用户帐户\管理帐户」中添加一个本地账户，然后选择一个文件夹右键选择「共享-特定用户」，添加新建的账户并授权它能读写文件夹。

Mac端打开Finder，由菜单依次选择「前往-连接服务器」，在弹出的界面中输入`smb://IP地址` 就会显示出Windows的验证窗口，输入账户名称和密码就可以完成登录。
￼
![](http://7q5cfr.com1.z0.glb.clouddn.com/@/mhj1/09.png)

图示范例中10.211.55.3是要访问的Windows设备的IP地址。
